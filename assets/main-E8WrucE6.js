import{r as l,s as p,j as e,i as j,S as g,a as v,b as w,f as E,m as y,e as T,c as b,d as N,g as C,h as R,R as k}from"./index-C0QgFtcZ.js";function F(){const[r,a]=l.useState("static"),[n,i]=l.useState("none"),u=l.useMemo(()=>n==="none"?void 0:p[n],[n]);return e.jsxs(e.Fragment,{children:[e.jsxs("header",{children:[e.jsx("div",{children:e.jsxs("label",{children:["Template:"," ",e.jsx("select",{value:r,onChange:s=>{console.log(s.type,s.target.value,s),j(s.target.value)&&a(s.target.value)},children:g.map(s=>e.jsx("option",{value:s,children:s},s))})]})}),e.jsx("div",{children:e.jsxs("label",{children:["Theme:"," ",e.jsxs("select",{value:n,onChange:s=>{v(s.target.value)&&i(s.target.value)},children:[e.jsx("option",{value:"none",children:"None"}),Object.keys(p).map(s=>e.jsx("option",{value:s,children:s},s))]})]})})]}),e.jsx(w,{template:r,theme:u})]})}function H(r){const{searchParams:a}=new URL(r),[n]=l.useState(a.get("file")),[i]=l.useState(a.get("gist")),[u,s]=l.useState(null);return l.useEffect(()=>{if(!n)return;const t=new URL(n,location.href).href;fetch(t).then(async h=>{const o=await h.text();s([n,{code:o}])})},[n]),l.useEffect(()=>{i&&E(i,{fetch}).then(async t=>{const[h,o]=Object.entries(t.files).find(([f])=>f.endsWith(".md"))??[];if(!o){console.warn("could not find markdown files from:",t);return}const c=o.content;s([h,{code:c}])})},[i]),{fileEntry:u,setFileEntry:s}}function A(r){const{searchParams:a}=new URL(r),[n]=l.useState(a.getAll("file")),[i,u]=l.useState(null),[s,t]=l.useState(null);return l.useEffect(()=>{if(!(n!=null&&n.length))return;let h=!1;Promise.all(n.map(async(o,c)=>{o.startsWith("/")||(o=`/${o}`),o.endsWith("!")&&(o=o.slice(0,-1),t(o),h=!0);const d=await(await fetch(o)).text();return[o,{code:d,active:c===0}]})).then(o=>{!h&&o.length===1&&t(o[0][0]);const c=o.reduce((f,[d,m])=>({...f,[d]:m}),{});u(c)})},[n]),{files:i,entryFile:s,setFiles:u,setEntryFile:t,fileParams:n}}function M(){const{files:r,entryFile:a}=A(location.href),[n,i]=l.useState(!0),[u,s]=l.useState("vanilla"),[t,h]=l.useState("none"),o=l.useMemo(()=>t==="none"?void 0:p[t],[t]);return console.count("App"),e.jsxs(e.Fragment,{children:[e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",position:"relative"},children:[e.jsx("div",{children:n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("label",{children:["Template:"," ",e.jsx("select",{value:u,onChange:c=>{console.log(c.type,c.target.value,c),j(c.target.value)&&s(c.target.value)},children:g.map(c=>e.jsx("option",{value:c,children:c},c))})]})}),e.jsx("div",{children:e.jsxs("label",{children:["Theme:"," ",e.jsxs("select",{value:t,onChange:c=>{v(c.target.value)&&h(c.target.value)},children:[e.jsx("option",{value:"none",children:"None"}),Object.keys(p).map(c=>e.jsx("option",{value:c,children:c},c))]})]})})]})}),e.jsx("div",{children:e.jsx("button",{onClick:()=>{i(c=>!c)},children:n?"Hide":"Show"})})]}),e.jsx("main",{style:{margin:"auto"},children:e.jsx(w,{template:u,theme:o,files:r??void 0,entry:a??void 0,showTabs:!0,editorHeight:"90vh"})})]})}function O({fileEntry:r}){const[a,n]=l.useState([]),[i,u]=l.useState([]);return l.useEffect(()=>{if(!r)return;const[s,t]=r;if(!s.endsWith(".md")){console.warn("not a markdown file.");return}const h=y.lexer(t.code);console.log("ðŸš€ lexerTokens:",h);const o=T(h);n(o);const c=b(h);u(c)},[r]),{contentEntries:a,contentEntriesPerPage:i}}function P({containerRef:r,timeout:a=0}){const{didScrollOnMountRef:n}=L({url:location.href,timeout:a,containerRef:r});U({timeout:a,containerRef:r,didScrollOnMountRef:n})}function S(r,a){if(a===null)r();else return setTimeout(()=>{r()},a)}function L({url:r,containerRef:a,timeout:n=null}){const i=l.useRef(!1),s=new URL(r).hash;return s?(l.useEffect(()=>{const t=S(()=>{if(!a.current)return;const o=Number(s.slice(1))-1;if(o===0){window.scrollTo(0,0),i.current=!0;return}const c=a.current.querySelector(`:scope > hr:nth-of-type(${o})`);if(!c){console.warn(`could not find ${o}th hr, abort scroll.`),i.current=!0;return}c.scrollIntoView(),i.current=!0},n);return()=>t&&clearTimeout(t)},[]),{didScrollOnMountRef:i}):(i.current=!0,{didScrollOnMountRef:i})}function U({containerRef:r,didScrollOnMountRef:a,timeout:n=null}){const i=l.useRef(new Map);l.useEffect(()=>{let u;const s=S(()=>{if(!r.current)return;const h=r.current.querySelectorAll(":scope > hr");u=new IntersectionObserver(o=>{const c=o.filter(({isIntersecting:d})=>d),f=o.filter(({isIntersecting:d})=>!d);c.forEach(d=>{i.current.set(d.target,!0)}),f.forEach(d=>{i.current.set(d.target,!1)})},{}),h.forEach(o=>{u.observe(o)}),console.log("observing intersections...",h.length)},n),t=N(h=>{var d;if(!a.current)return;if(window.scrollY===0){history.replaceState({prev:new URL(location.href).hash},"",location.href.split("#")[0]);return}const o=C([...i.current.entries()].filter(([m,x])=>x).map(([m])=>m),m=>m.getBoundingClientRect().top);if(!o)return;const f=[...((d=r.current)==null?void 0:d.querySelectorAll(":scope > hr"))??[]].indexOf(o);f!==-1&&history.replaceState({prev:new URL(location.href).hash},"",`#${f+2}`)},100);return window.addEventListener("scroll",t),()=>{u==null||u.disconnect(),window.removeEventListener("scroll",t),s&&clearTimeout(s)}},[])}function I(){const{fileEntry:r}=H(location.href),{contentEntries:a,contentEntriesPerPage:n}=O({fileEntry:r});l.useEffect(()=>{console.log("ðŸš€ ~ file: MarkdownApp.tsx:18 ~ MarkdownApp ~ contents:",n)},[a,n]);const i=l.useRef(null);P({containerRef:i,timeout:500});const[u,s]=l.useState("vanilla"),[t,h]=l.useState("none"),o=l.useMemo(()=>t==="none"?void 0:p[t],[t]);return console.count("MarkdownApp"),e.jsxs(e.Fragment,{children:[e.jsx($,{templateName:u,setTemplateName:s,themeName:t,setThemeName:h}),e.jsx("main",{ref:i,style:{margin:"auto"},children:n.map((c,f,d)=>e.jsxs(l.Fragment,{children:[e.jsx("article",{style:{minHeight:"80vh"},children:c.map((m,x)=>typeof m=="string"?e.jsx(_,{html:m},x):m[0]&&e.jsx(l.Fragment,{children:e.jsx("div",{children:e.jsx(w,{template:u,theme:o,showTabs:!0,files:Object.fromEntries(m),entry:m[0][0]})})},x))}),f!==d.length-1&&e.jsx("hr",{})]},f))})]})}const _=({html:r,onMount:a})=>{const n=l.useRef(null);return l.useEffect(()=>{if(!n.current||!r)return;const i=setTimeout(()=>{if(n.current&&n.current.parentNode){const u=n.current;u.outerHTML=r,a==null||a()}},0);return()=>clearTimeout(i)},[r]),e.jsx("div",{ref:n})};function $({templateName:r,setTemplateName:a,themeName:n,setThemeName:i}){const[u,s]=l.useState(!0);return e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",position:"relative"},children:[e.jsx("div",{children:u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("label",{children:["Template:"," ",e.jsx("select",{value:r,onChange:t=>{j(t.target.value)&&a(t.target.value)},children:g.map(t=>e.jsx("option",{value:t,children:t},t))})]})}),e.jsx("div",{children:e.jsxs("label",{children:["Theme:"," ",e.jsxs("select",{value:n,onChange:t=>{v(t.target.value)&&i(t.target.value)},children:[e.jsx("option",{value:"none",children:"None"}),Object.keys(p).map(t=>e.jsx("option",{value:t,children:t},t))]})]})})]})}),e.jsx("div",{children:e.jsx("button",{onClick:()=>{s(t=>!t)},children:u?"Hide":"Show"})})]})}const W={Index:F,App:M,Markdown:I};function q(r){return r[0].toUpperCase()+r.substring(1)}function B(){const{pathname:r}=new URL(location.href),a=q(r.replace(/^\//,"").split("/").slice(1).join("/").replace(/[.]html$/,"")),n=W[a];return e.jsx(n,{})}R.createRoot(document.getElementById("root")).render(e.jsx(k.StrictMode,{children:e.jsx(B,{})}));
